package backend

import (
	"net/http"
	"time"

	"github.com/gorilla/mux"
)

func NewHttpServer(a string) *http.Server {
	r := mux.NewRouter()
	s := r.PathPrefix("/grafana").Subrouter()
	s.PathPrefix("/data/").Handler(http.StripPrefix("/grafana/data/", http.FileServer(http.Dir("./data"))))
	s.HandleFunc("/refresh_data", refreshData).Methods(http.MethodGet)
	s.HandleFunc("/reload_config", reloadConfig).Methods(http.MethodGet)
	//s.HandleFunc("/dash", dashHandler).Methods(http.MethodGet)
	return &http.Server{
		Addr:         a,
		Handler:      s,
		ReadTimeout:  10 * time.Second,
		WriteTimeout: 10 * time.Second,
	}
}
