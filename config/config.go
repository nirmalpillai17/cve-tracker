package config

import (
	"encoding/json"
	"os"
)

type ConfigMap struct {
	RequestURL string `json:"request_uri"`
	HeaderFile string `json:"header_file"`
	PlMain     string `json:"payload_main"`
	PlDirector string `json:"payload_director"`
	OutDir     string `json:"out_dir"`
}

func NewConfigMap() (ConfigMap, error) {
	config := ConfigMap{}
	if err := config.ReadConfig(); err != nil {
		return config, err
	}
	return config, nil
}

func (cm *ConfigMap) ReadConfig() error {
	basePath, err := os.Getwd()
	if err != nil {
		return err
	}
	data, err := os.ReadFile(basePath + "/config.json")
	if err = json.Unmarshal(data, cm); err != nil {
		return err
	}
	return nil
}
