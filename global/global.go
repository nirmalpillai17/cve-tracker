package global

import (
	"log"
	"os"
	"time"

	"github.com/nirmalpillai17/cve_tracker/config"
	"github.com/nirmalpillai17/cve_tracker/logger"
)

var Cl logger.CustomLogger
var Cm config.ConfigMap
var Bp string
var Lf *os.File
var Loc *time.Location

func init() {
	var err error
	Bp, err = os.Getwd()
	if err != nil {
		log.Fatal("failed to find base directory")
	}

	Cm, err = config.NewConfigMap(Bp + "/config.json")
	if err != nil {
		log.Fatal("failed to create configmap")
	}
	
	Lf, err = os.Create(Bp + "/" + Cm.LogFile)
	if err != nil {
		log.Fatal("failed to open logs file")
	}
	Cl = logger.NewLogger(Lf) 

	Loc, err = time.LoadLocation("Asia/Kolkata")
	if err != nil {
		log.Fatal("failed to initialize time zone")
	}
}
